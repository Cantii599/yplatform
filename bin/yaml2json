#!/usr/bin/env -S deno run

// Convert YAML to JSON

// alternative:
// python3 -c 'import sys, yaml, json;
// print(json.dumps(yaml.load(sys.stdin.read(),Loader=yaml.FullLoader), sort_keys=False, indent=2))'

import yml from 'https://cdn.skypack.dev/js-yaml@3.14.1';

let buf = new Uint8Array(1024);
let n = await Deno.stdin.read(buf);
let data = new TextDecoder().decode(buf.subarray(0, n)).trim();
let ymlData = yml.load(data);
let jsonData = yml.load(yml.dump(ymlData, {
  noRefs: true
}));
let jsonStringData = JSON.stringify(jsonData, null, 2);
let text= new TextEncoder().encode(jsonStringData);
await Deno.stdout.write(text);

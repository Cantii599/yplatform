# 0. Misc
matrix:
  include:
    - name: "Linux Trusty 14.04 with minimal brew"
      os: linux
      dist: trusty
      env: CACHE_NAME=linux-trusty-minimal SF_CI_BREW_INSTALL=minimal

    - name: "Linux Trusty 14.04 with common brew"
      os: linux
      dist: trusty
      env: CACHE_NAME=linux-trusty-common SF_CI_BREW_INSTALL=common
      if: type IN (push, cron)

    - name: "Linux Xenial 16.04 with minimal brew"
      os: linux
      dist: xenial
      env: CACHE_NAME=linux-xenial-minimal SF_CI_BREW_INSTALL=minimal

    - name: "Linux Xenial 16.04 with common brew"
      os: linux
      dist: xenial
      env: CACHE_NAME=linux-xenial-common SF_CI_BREW_INSTALL=common
      if: type IN (push, cron)

    - name: "OSX High Sierra 10.13 (Xcode 10.1) with dev brew"
      os: osx
      osx_image: xcode10.1
      env: CACHE_NAME=osx-xcode10.1-dev SF_CI_BREW_INSTALL=dev
      if: type IN (push, cron)

# 1. Notifications
notifications:
  slack:
    rooms:
      # atex-ci
      - secure: "PHjlBIIt+ggW94UypB1yP/Sjm8eV6jaGkKXtMeRUcs0WY2TV20a/rojlPh90quCtln/DPWI1wuS4UrPsvmy7PtFrRICX6FO+Aoc5fm/SZ7v0wVidcO61ThcM1OHz2F1oXXwxstITKpveBHCsKtYNHFkOzytJO6haZnqWq0klJUU/TfGBvJ+WNIzVKPQc0vbdjRzzUHMkPzZFk7DPRCaWD6/J2rGY+Xm9s1FBbXTpqaj6uAmCU1FeXi/oTKhpIFRrSO8UPxtxQeg45i7GEhq1tB8MW6SrV9oo10iNPrHQ7f8r+qfrIK1RAaL6SfhmB5+ghz1ckOMMgUXyqBkMKMbdf7k98acXAZwkR3IPN/qcSg8Dd2BZVbKArHxTafVppJkjrd3F1Mpq5PW1ON8HqBek0YyrYpadXG9JLaGHK00wbmu6ruX5tdgpTAlboZnV0X/TEgqbC5cZFrAylIV8bQNLEFZf/mdzxPp5SyApO25d/kIwygbC5ysLhWHomsSzA7AC/X28QqlDx37gF75Btd55wSN8TllxA1gQtBjN5C1HMrJ20+b+FBoYBBi1D8IpepgxVeRC63pZvzPGbfNv+MOQLD0yrYaBbg29mKMAs7lerNddAIbJrx3xqaR4xXu0TBUjjLdFULmzySTCjkfeXCUx0FW06D6rAgg1KgYiDZPNo14="
      # cloud-ci
      - secure: "EFN/yGMW+CNrwyqBzJiJOFZIytEIGsz2zBO/s34sCHwk8UukrOJBqSgv1LycjudPr6MizY5ax/IOZkG6fs8ce2Z8qJKNdQC2OHKVXq5Rr5x2HMg3ihoqhEVJhohS2B337TcF6/0WHZ/BT32tOFI1M2Z3WGByxsvrRFTa5eFDxRz+KfyOiWAKjTgY5cG5Sjr3Cmy9vQTFQkWgkSKvIemOCF7q1REFPAg917EvIaZfY2nUT9w9thtvIL3u2JUmWEda+X13oTm5ywEeFo8AYK8CR1PnVfi9O/172Gh8jhPzcjbkl6kEO5E73xPhCAnAoBgIaeQ9cq8kn3uZQeG0cHve55Os8kRGjT/ZFCa/c4XuFkQnLLlNRSJBlQ76EmhU43TianvnwJt/s9H1+ak9pypY5NYe/bx3NMd0BuhkhHB/zcKq96x/ZE7yiJcpsMw+7voVR+CNec4WsrukEDfiily+9A9M9+cB66z25dpsbKIVe6REer+MD9RTwc2n8M00TBmnB14KGQAE8HEXdzTSF5LWcT1T4nxgHeRKMur185KSovAFEB+93CApAN1NU/ooZRqpYkOLd6weDl6c5il4tZ7iPgDmSlLS9a+17lJ4GwNk9pxd398inYV9XSZGF5ZZykSN9LDipdx1VnRrVW/tSS3B9dt6jlvscB5sWbfr9+k5m7o="
    on_success: change
    on_pull_requests: false

# 2. Env
env:
  global:
    # GH_TOKEN
    - secure: "iCXBoS2H3R6xefnQNPbI0hZViDgDbuzkLJ6b1PYsshldjFecAwkudVCokmlNlBErESHQ/z2yTzjFGMZdsxLsmM7ifLDHHL9NhXoX3utA2wmolqQfRnic82ElR028lG6LVT11FbiA/CdjsFeqyq14wpXNhnUlr/2hw2fR8Pd3lNScF4444bNBiKdBwsoFCZY2MDei8+GNvAK+a/lzWQbwsoo6v0CfsegTaOeXvitxrfl+rcRALRZj8xtTFegTXS4bPSNFt6Yj7gFpfieNNyu2606OFoWXRoDxF/WEZWI5PhwT6J7b6sV14Ch/ZWyOBfU9Q1aszZI/FbosY1+6asxSPc4q76o3YmYDn8lS8fU4yqKVLq6T/kju1v/9ea5J7hQI2msdHn66orS7L+u01UWvArYiiVjkWB2+yjiwXG7j4u+gsm2bYo3Y1cCPBrIWDih3vjfr2Tm6BWk9LfEnpWUkZYxdSo30MYGShSAQAAxVtopZGfa32oG231YtUqzC5Oc2j2SCMMxoAqcVTuQhx7BM9bVLijTtMW7hOPqfxKDiWOu8Y5i6jqgeOEKoXCFp0znAnV8t2KjH2o9G2Odnsg9nJDeebR7sUp1ul3Jmr1yUlexPd+e/M8Nki+2Qprj89bH3uHvz2oSeUxdBx1U5+2++ig+F8XStRDr0vjScKDStEJc="
    # TRANSCRYPT_PASSWORD
    - secure: "ZqAHqLi804+FLx0R/ZdT3c33B//ypG3a827nOyhceTZUIcheqvL6PxPcfjwxba1hawm5E0B6gS9RBIFXbTyH07ZMnBsdio5iiUuDnOFCXYujVCXoNTkjo1Vlsu2HC8/KR6a5kWvt2UD8MbJ1+Cpur9N9F5dCGEsOFeFB7OvbKx38rxSnXxvNhdVPK+0Zi6jvZafAkUjjSfmgvXWlEFY0cOxjZmslU/KyJM32DiCn3Z8WysGccYIqFQLBYfjfY7n12WBQttXY6JhaEi4Ht1ePWPpfNDjBd4Y6VaMrKDhZ3xPOwrG8AIbOkzJrrTFgXpCFxaavXdkr2H/yYWYec6HuHwAbWvvgIwv84JXFjRRHYUy+Iev+KNIsa4LPFCC9YJDMJk3QJ3O3daS4XejqMDqVv4WudYECy+VtUqZRui9wVC7cRTc30vCCRiqRA9P3p8AlZzS1CoPFXwgFfieZRwbreEJjEBO2sizNmsWnBPxrkvSey4FxR5nHyk487YIfv/3PUCnoZ0gtUuOn2MUvxZMIOlN6LgL6czdIhxLMpulZJjPBeqO6A344wgU22luyKL2bJ6pgraIu+PWUkSQ/RMv6ZZtpD3rPVeY84nI5KDYY2eZLUvQJSBe+uM65Wqpbh6xWCSfmWpB+LwZ7zorzjgO1F6VwGXuci4Crg3mZh6rW528="
    # SF_LOG_BOOTSTRAP
    - "SF_LOG_BOOTSTRAP=true"

# 3. Git
# git:
branches:
  only:
    - master

# 4. Bootstrap
# os: linux
# dist: xenial
language: generic
# addons:
before_cache: ./.ci.sh before_cache
cache:
  directories:
    # common
    - $HOME/.local
    - $HOME/.npm
    # darwin
    - $HOME/.homebrew
    - $HOME/Library/Caches/Homebrew
    - $HOME/Library/Caches/pip
    # linux
    - $HOME/.cache/Homebrew
    - $HOME/.cache/pip
    - $HOME/.linuxbrew

# 5. Steps
before_install: ./.ci.sh before_install
install: ./.ci.sh install
before_script: ./.ci.sh before_script
script: ./.ci.sh script
after_success: ./.ci.sh after_success
after_failure: ./.ci.sh after_failure
after_script: ./.ci.sh after_script

# 6. Deploy
before_deploy: ./.ci.sh before_deploy
# deploy:
after_deploy: ./.ci.sh after_deploy
